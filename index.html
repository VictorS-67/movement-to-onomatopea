<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movement description using onomatopea</title>
    <script src="https://unpkg.com/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            text-align: center;
        }
        .video-container {
            margin-bottom: 1rem;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            overflow: hidden; /* To contain rounded corners of video */
        }
        #myVideo {
            width: auto;
            height: auto;
        }
        .input-group {
            display: flex;
            flex-direction: column;
            margin-bottom: 1rem;
        }
        .input-group label {
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #374151;
            text-align: left;
        }
        .input-group input, .input-group textarea {
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }
        .input-group textarea {
            resize: vertical;
            min-height: 4rem;
        }
        .button {
            padding: 0.75rem 1.5rem;
            background-color: #4f46e5;
            color: #fff;
            font-weight: 600;
            border-radius: 0.375rem;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-size: 1rem;
            margin: 0.5rem 0;
        }
        .button:hover {
            background-color: #4338ca;
        }
        #timestampDisplay {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #6b7280;
        }
    </style>
</head>

    

    

    
<body class="bg-gray-100">
    
    <div class="container">
        <p id="videoTitle">Video 1.mp4</p>
        <div class="video-container">
            <!--
            <iframe
                id="myVideo"
                src="https://drive.google.com/file/d/1wONpmPkKvBX0gaUiFI9tY2ielxd415fh/preview" 
                width="640" 
                height="480" 
                frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                allowfullscreen
                title="point light motion"
            ></iframe>
            -->
            <video
                id="myVideo"
                src="videos/1.mp4" 
                controls
                title="point light motion"
            >
                Your browser does not support the video tag.
            </video>
        </div>

        <!-- Dropdown to Select Video -->
        <div class="dropdown">
            <label for="videoSelect">Change the video:</label>
            <select id="videoSelect">
            </select>
        </div>

        <div class="input-group">
            <label for="opinion">Your Opinion:</label>
            <textarea id="opinion" name="opinion" placeholder="Write your opinion about this part of the video"></textarea>
        </div>

        <button id="getTimestamp" class="button">Get Timestamp</button>
        <p id="timestampDisplay">Current Timestamp: --:--</p>

        <button id="saveOpinion" class="button">Save Opinion</button>

        <div id="message" class="mt-4 text-gray-700"></div>
    </div>

    <script>
        const videoTitle = document.getElementById("videoTitle");
        const videoPlayer = document.getElementById("myVideo");
        const videoSelect = document.getElementById('videoSelect');
        const getTimestampButton = document.getElementById("getTimestamp");
        const timestampDisplay = document.getElementById("timestampDisplay");
        const opinionInput = document.getElementById("opinion");
        const saveOpinionButton = document.getElementById("saveOpinion");
        const messageDisplay = document.getElementById("message");

        let opinions = []; // Array to store opinions

        // function to fetch the list of video files
        const fetchFilesInFolder = async () => {
          const owner = "VictorS-67"; // GitHub username
          const repo = "movement-to-onomatopea"; // Repository name
          const folder = "videos"; // Folder path
        
          const url = `https://api.github.com/repos/${owner}/${repo}/contents/${folder}`;
        
          try {
            const response = await fetch(url, {
              headers: {
                Accept: "application/vnd.github.v3+json",
              },
            });
        
            if (!response.ok) {
              throw new Error(`Failed to fetch files: ${response.statusText}`);
            }
        
            const files = await response.json();
        
            // Filter and return the files as an array of filenames
            const fileList = files
              .filter(file => file.type === "file")
              .map(file => file.name); // Extract only the file names
        
            return fileList; // Return the list of files
          } catch (error) {
            console.error("Error:", error.message);
            return []; // Return an empty array in case of error
          }
        };

         // List of videos fetched from the repository
        const videos = fetchFilesInFolder()
        /*const videos = [
            "1.mp4",
            "10.mp4",
            "100.mp4",
            "101.mp4",
            "102.mp4",
            "103.mp4",
            // Add all filenames here based on fetched content
        ];*/
    
        // Populate the dropdown dynamically
        videos.forEach(video => {
            const option = document.createElement("option");
            option.value = `videos/${video}`;
            option.textContent = video; // Display the video filename
            videoSelect.appendChild(option);
        });
    
        // Update video source when dropdown changes
        videoSelect.addEventListener("change", () => {
            videoPlayer.src = videoSelect.value;
            videoPlayer.load();
            videoTitle.textContent = `Video: ${videoSelect.value}`;
        });

        
        // Function to get and display the current timestamp
        getTimestampButton.addEventListener("click", () => {
            const currentTime = videoPlayer.currentTime;
            timestampDisplay.textContent = `Current Timestamp: ${currentTime.toFixed(2)} seconds`;
        });

        // Function to save the opinion and timestamp
        saveOpinionButton.addEventListener("click", () => {
            const currentTime = videoPlayer.currentTime;
            const opinion = opinionInput.value.trim();

            if (opinion === "") {
                messageDisplay.textContent = "Please enter your opinion.";
                messageDisplay.style.color = "red";
                return;
            }

            // Create an object to store the timestamp and opinion
            const opinionData = {
                timestamp: currentTime.toFixed(2),
                opinion: opinion,
            };

            opinions.push(opinionData); // Add to the array

            // Display a success message
            messageDisplay.textContent = "Opinion and timestamp saved!";
            messageDisplay.style.color = "green";

            // Clear the opinion input
            opinionInput.value = "";
            timestampDisplay.textContent = ""; // Clear timestamp display after saving
            // You can optionally save the opinions to a server here using fetch()
            // Example of sending data to a server (you'll need a server-side script to handle this):
            /*
            fetch('/save-opinion', {  //  Replace '/save-opinion' with your server endpoint
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(opinionData),
            })
            .then(response => {
                if (response.ok) {
                    messageDisplay.textContent = "Opinion and timestamp saved to server!";
                    messageDisplay.style.color = "green";
                } else {
                    messageDisplay.textContent = "Error saving opinion. Please try again.";
                    messageDisplay.style.color = "red";
                }
            })
            .catch(error => {
                console.error('Error:', error);
                messageDisplay.textContent = "Error saving opinion. Please check your network connection.";
                messageDisplay.style.color = "red";
            });
            */
        });
    </script>
</body>
</html>
